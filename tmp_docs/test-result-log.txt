ðŸ”§ Preparing test environment...

âœ… Virtual environment activated

ðŸ“¦ Generating gRPC stubs for tests...
ðŸ“¦ Generating orchestrator stubs...
ðŸ“¦ Generating context stubs...
ðŸ“¦ Generating planning stubs...
ðŸ“¦ Generating context stubs for planning...
ðŸ“¦ Generating task-derivation stubs...
ðŸ“¦ Generating context stubs for task-derivation...
ðŸ“¦ Generating ray_executor stubs for task-derivation...
ðŸ“ Creating __init__.py files...
âœ… gRPC stubs generated successfully

ðŸ§ª Running unit tests...

ðŸ“¦ Running core tests...
============================= test session starts ==============================
platform linux -- Python 3.13.7, pytest-8.4.2, pluggy-1.6.0
rootdir: /home/tirso/ai/developents/swe-ai-fleet
configfile: pytest.ini
plugins: anyio-4.11.0, cov-7.0.0, asyncio-1.2.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 976 items

core/agents_and_tools/tests/unit/agents/application/services/test_step_execution_service.py . [  0%]
...........                                                              [  1%]
core/agents_and_tools/tests/unit/agents/application/usecases/test_collect_artifacts_usecase.py . [  1%]
...                                                                      [  1%]
core/agents_and_tools/tests/unit/agents/application/usecases/test_execute_task_iterative_usecase.py . [  1%]
......................                                                   [  3%]
core/agents_and_tools/tests/unit/agents/application/usecases/test_generate_next_action_usecase.py . [  4%]
.....                                                                    [  4%]
core/agents_and_tools/tests/unit/agents/application/usecases/test_generate_plan_usecase.py . [  4%]
......                                                                   [  5%]
core/agents_and_tools/tests/unit/agents/application/usecases/test_log_reasoning_usecase.py . [  5%]
......                                                                   [  6%]
core/agents_and_tools/tests/unit/agents/application/usecases/test_summarize_result_usecase.py . [  6%]
..                                                                       [  6%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_artifact.py . [  6%]
.......                                                                  [  7%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_artifacts.py . [  7%]
...........                                                              [  8%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_audit_trail.py . [  8%]
....                                                                     [  8%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_audit_trails.py . [  9%]
...........                                                              [ 10%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_observation_histories.py . [ 10%]
..........                                                               [ 11%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_observation_history.py . [ 11%]
..                                                                       [ 11%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_operations.py . [ 11%]
...........................                                              [ 14%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_reasoning_log.py . [ 14%]
..                                                                       [ 14%]
core/agents_and_tools/tests/unit/agents/domain/entities/collections/test_reasoning_logs.py . [ 14%]
.........                                                                [ 15%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_agent_id.py . [ 15%]
........                                                                 [ 16%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_agent_profile.py . [ 16%]
.............                                                            [ 18%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_agent_result.py . [ 18%]
......                                                                   [ 18%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_agent_thought.py . [ 18%]
.....                                                                    [ 19%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_execution_constraints.py . [ 19%]
.....                                                                    [ 20%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_execution_plan.py . [ 20%]
......                                                                   [ 20%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_execution_step.py . [ 20%]
...........                                                              [ 22%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_operation.py . [ 22%]
................                                                         [ 23%]
core/agents_and_tools/tests/unit/agents/domain/entities/core/test_tool_type.py . [ 23%]
......                                                                   [ 24%]
core/agents_and_tools/tests/unit/agents/domain/entities/rbac/test_action.py . [ 24%]
.................................                                        [ 27%]
core/agents_and_tools/tests/unit/agents/domain/entities/rbac/test_role.py . [ 28%]
................                                                         [ 29%]
core/agents_and_tools/tests/unit/agents/domain/entities/rbac/test_role_factory.py . [ 29%]
...........................................                              [ 34%]
core/agents_and_tools/tests/unit/agents/domain/entities/results/test_file_execution_result.py . [ 34%]
.....                                                                    [ 34%]
core/agents_and_tools/tests/unit/agents/domain/entities/results/test_step_execution_result.py . [ 34%]
.....                                                                    [ 35%]
core/agents_and_tools/tests/unit/agents/infrastructure/adapters/test_tool_execution_adapter.py . [ 35%]
........                                                                 [ 36%]
core/agents_and_tools/tests/unit/agents/infrastructure/adapters/test_vllm_client_adapter.py . [ 36%]
...                                                                      [ 36%]
core/agents_and_tools/tests/unit/agents/test_profile_loader.py ......... [ 37%]
...............                                                          [ 39%]
core/agents_and_tools/tests/unit/agents/test_toolset.py ................ [ 40%]
                                                                         [ 40%]
core/agents_and_tools/tests/unit/agents/test_vllm_agent_gaps.py ........ [ 41%]
..........                                                               [ 42%]
core/agents_and_tools/tests/unit/common/domain/entities/test_capability.py . [ 42%]
.......                                                                  [ 43%]
core/agents_and_tools/tests/unit/common/domain/entities/test_capability_collection.py . [ 43%]
..............                                                           [ 45%]
core/agents_and_tools/tests/unit/common/domain/entities/test_execution_mode.py . [ 45%]
...                                                                      [ 45%]
core/agents_and_tools/tests/unit/common/domain/entities/test_tool_definition.py . [ 45%]
........                                                                 [ 46%]
core/agents_and_tools/tests/unit/common/domain/entities/test_tool_registry.py . [ 46%]
...............                                                          [ 48%]
core/agents_and_tools/tests/unit/tools/test_tools_basic_gaps.py ........ [ 48%]
.......                                                                  [ 49%]
core/context/tests/unit/adapters/test_neo4j_command_store_project.py ... [ 49%]
.......                                                                  [ 50%]
core/context/tests/unit/adapters/test_neo4j_query_store.py ......s...... [ 51%]
........                                                                 [ 52%]
core/context/tests/unit/adapters/test_neo4j_query_store_hexagonal.py s.. [ 53%]
..............s..                                                        [ 54%]
core/context/tests/unit/adapters/test_redis_planning_read_adapter.py ... [ 55%]
..............................                                           [ 58%]
core/context/tests/unit/adapters/test_redis_planning_read_adapter_hexagonal.py . [ 58%]
.......................                                                  [ 60%]
core/context/tests/unit/application/test_rbac_context_service_simple.py . [ 60%]
..                                                                       [ 60%]
core/context/tests/unit/application/usecases/test_handle_story_phase_transition.py . [ 61%]
...                                                                      [ 61%]
core/context/tests/unit/application/usecases/test_process_context_change_usecase.py . [ 61%]
.........                                                                [ 62%]
core/context/tests/unit/application/usecases/test_publish_context_updated.py . [ 62%]
......                                                                   [ 63%]
core/context/tests/unit/application/usecases/test_publish_rehydrate_session_response.py . [ 63%]
......                                                                   [ 63%]
core/context/tests/unit/application/usecases/test_publish_update_context_response.py . [ 63%]
......                                                                   [ 64%]
core/context/tests/unit/domain/services/test_authorization_checker.py .. [ 64%]
......                                                                   [ 65%]
core/context/tests/unit/domain/services/test_column_filter_service.py .. [ 65%]
.....                                                                    [ 66%]
core/context/tests/unit/domain/services/test_data_indexer.py ..........  [ 67%]
core/context/tests/unit/domain/services/test_decision_selector.py ...... [ 67%]
...                                                                      [ 68%]
core/context/tests/unit/domain/services/test_impact_calculator.py ...... [ 68%]
...                                                                      [ 68%]
core/context/tests/unit/domain/services/test_token_budget_calculator.py . [ 69%]
.............                                                            [ 70%]
core/context/tests/unit/domain/test_context_sections_gaps.py .........   [ 71%]
core/context/tests/unit/domain/test_domain_event_gaps.py ...             [ 71%]
core/context/tests/unit/domain/test_entity_type.py ...........           [ 72%]
core/context/tests/unit/domain/test_epic_domain_invariants.py ....       [ 73%]
core/context/tests/unit/domain/test_get_role_based_context_request.py .. [ 73%]
........                                                                 [ 74%]
core/context/tests/unit/domain/test_phase_transition.py .........        [ 75%]
core/context/tests/unit/domain/test_project.py ........                  [ 75%]
core/context/tests/unit/domain/test_project_id.py .....                  [ 76%]
core/context/tests/unit/domain/test_project_status.py ............       [ 77%]
core/context/tests/unit/domain/test_role.py ...................          [ 79%]
core/context/tests/unit/domain/test_story_domain_invariants.py ......    [ 80%]
core/context/tests/unit/domain/value_objects/test_authorization_result.py . [ 80%]
.......                                                                  [ 81%]
core/context/tests/unit/domain/value_objects/test_column_policy.py ..... [ 81%]
....                                                                     [ 81%]
core/context/tests/unit/domain/value_objects/test_data_access_log_entry.py . [ 82%]
..........                                                               [ 83%]
core/context/tests/unit/domain/value_objects/test_role_visibility_policy.py . [ 83%]
..........                                                               [ 84%]
core/context/tests/unit/infrastructure/dtos/test_rehydrate_session_response_dto.py . [ 84%]
......                                                                   [ 84%]
core/context/tests/unit/infrastructure/dtos/test_rehydration_stats_dto.py . [ 85%]
....                                                                     [ 85%]
core/context/tests/unit/infrastructure/dtos/test_update_context_response_dto.py . [ 85%]
....                                                                     [ 85%]
core/context/tests/unit/infrastructure/mappers/test_project_mapper.py .. [ 86%]
......                                                                   [ 86%]
core/memory/tests/unit/test_dtos_and_basics.py .................         [ 88%]
core/ray_jobs/tests/unit/application/test_execute_agent_task.py .ss..    [ 89%]
core/ray_jobs/tests/unit/application/test_generate_proposal.py ....      [ 89%]
core/ray_jobs/tests/unit/domain/test_agent_config.py ...s.sss.           [ 90%]
core/ray_jobs/tests/unit/infrastructure/adapters/test_asyncio_executor.py . [ 90%]
.....                                                                    [ 90%]
core/ray_jobs/tests/unit/infrastructure/adapters/test_vllm_http_client.py s [ 91%]
sssss                                                                    [ 91%]
core/ray_jobs/tests/unit/infrastructure/test_ray_agent_factory.py ..s..s [ 92%]
.                                                                        [ 92%]
core/ray_jobs/tests/unit/test_vllm_agent_job_unit.py ..sssssssssss       [ 93%]
core/reports/tests/unit/adapters/test_redis_planning_adapter_gaps.py ... [ 93%]
.                                                                        [ 94%]
core/reports/tests/unit/domain/test_graph_analytics_types_gap.py .       [ 94%]
core/shared/tests/unit/domain/value_objects/content/test_task_description.py . [ 94%]
.....                                                                    [ 94%]
core/shared/tests/unit/domain/value_objects/task_attributes/test_duration.py . [ 94%]
.......                                                                  [ 95%]
core/shared/tests/unit/domain/value_objects/task_attributes/test_priority.py . [ 95%]
........                                                                 [ 96%]
core/shared/tests/unit/domain/value_objects/task_derivation/config/test_task_derivation_config.py . [ 96%]
.......                                                                  [ 97%]
core/shared/tests/unit/domain/value_objects/task_derivation/test_keyword.py . [ 97%]
......                                                                   [ 98%]
core/shared/tests/unit/test_action.py ...................                [100%]

=============================== warnings summary ===============================
core/agents_and_tools/agents/domain/entities/results/test_execution_result.py:7
  /home/tirso/ai/developents/swe-ai-fleet/core/agents_and_tools/agents/domain/entities/results/test_execution_result.py:7: PytestCollectionWarning: cannot collect test class 'TestExecutionResult' because it has a __init__ constructor (from: core/agents_and_tools/agents/domain/entities/results/test_execution_result.py)
    @dataclass(frozen=True)

core/agents_and_tools/agents/domain/entities/results/test_execution_result.py:7
  /home/tirso/ai/developents/swe-ai-fleet/core/agents_and_tools/agents/domain/entities/results/test_execution_result.py:7: PytestCollectionWarning: cannot collect test class 'TestExecutionResult' because it has a __init__ constructor (from: core/agents_and_tools/common/infrastructure/mappers/test_result_mapper.py)
    @dataclass(frozen=True)

core/agents_and_tools/tools/test_tool.py:17
  /home/tirso/ai/developents/swe-ai-fleet/core/agents_and_tools/tools/test_tool.py:17: PytestCollectionWarning: cannot collect test class 'TestResult' because it has a __init__ constructor (from: core/agents_and_tools/common/infrastructure/mappers/test_result_mapper.py)
    @dataclass

core/agents_and_tools/tools/test_tool.py:29
  /home/tirso/ai/developents/swe-ai-fleet/core/agents_and_tools/tools/test_tool.py:29: PytestCollectionWarning: cannot collect test class 'TestTool' because it has a __init__ constructor (from: core/agents_and_tools/tests/unit/tools/test_tools_basic_gaps.py)
    class TestTool:

core/agents_and_tools/tools/test_tool.py:17
  /home/tirso/ai/developents/swe-ai-fleet/core/agents_and_tools/tools/test_tool.py:17: PytestCollectionWarning: cannot collect test class 'TestResult' because it has a __init__ constructor (from: core/agents_and_tools/tools/test_tool.py)
    @dataclass

core/agents_and_tools/tools/test_tool.py:29
  /home/tirso/ai/developents/swe-ai-fleet/core/agents_and_tools/tools/test_tool.py:29: PytestCollectionWarning: cannot collect test class 'TestTool' because it has a __init__ constructor (from: core/agents_and_tools/tools/test_tool.py)
    class TestTool:

core/context/tests/unit/application/usecases/test_handle_story_phase_transition.py:12
  /home/tirso/ai/developents/swe-ai-fleet/core/context/tests/unit/application/usecases/test_handle_story_phase_transition.py:12: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    pytestmark = pytest.mark.unit

core/context/tests/unit/domain/test_phase_transition.py:7
  /home/tirso/ai/developents/swe-ai-fleet/core/context/tests/unit/domain/test_phase_transition.py:7: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    pytestmark = pytest.mark.unit

core/context/tests/unit/application/usecases/test_handle_story_phase_transition.py::test_execute_invalidates_cache
core/context/tests/unit/application/usecases/test_handle_story_phase_transition.py::test_execute_records_transition
core/context/tests/unit/application/usecases/test_handle_story_phase_transition.py::test_execute_with_different_phases
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/asyncio/base_events.py:2051: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    handle = None  # Needed to break cycles when an exception occurs.
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.13.7-final-0 ________________

Name                                                                                  Stmts   Miss Branch BrPart   Cover   Missing
----------------------------------------------------------------------------------------------------------------------------------
core/agents_and_tools/adapters/model_loaders.py                                          90     90     22      0   0.00%   1-211
core/agents_and_tools/tools/helm_tool.py                                                  4      4      0      0   0.00%   1-6
core/agents_and_tools/tools/kubectl_tool.py                                               6      6      0      0   0.00%   1-9
core/agents_and_tools/tools/psql_tool.py                                                  4      4      0      0   0.00%   1-6
core/agents_and_tools/tools/tool.py                                                       1      1      0      0   0.00%   9
core/context/adapters/neo4j_story_authorization_adapter.py                               31     31     10      0   0.00%   3-129
core/context/context_assembler.py                                                        48     48      8      0   0.00%   1-225
core/context/domain/scopes/prompt_blocks.py                                               7      7      0      0   0.00%   1-17
core/context/domain/scopes/prompt_scope_policy.py                                        19     19      0      0   0.00%   1-64
core/context/domain/scopes/scope_check_result.py                                          6      6      0      0   0.00%   1-8
core/context/session_rehydration.py                                                     107    107     32      0   0.00%   9-259
core/context/usecases/project_epic.py                                                    10     10      0      0   0.00%   2-31
core/context/usecases/projector_coordinator.py                                           20     20      2      0   0.00%   2-33
core/context/usecases/update_task_status.py                                              11     11      0      0   0.00%   2-33
core/orchestrator/config_module/agent_configuration.py                                    8      8      0      0   0.00%   1-11
core/orchestrator/config_module/role_config.py                                            6      6      0      0   0.00%   1-8
core/orchestrator/config_module/system_config.py                                          6      6      0      0   0.00%   1-9
core/orchestrator/config_module/vllm_config.py                                           21     21      0      0   0.00%   3-81
core/orchestrator/domain/check_results/check_result.py                                    9      9      0      0   0.00%   3-36
core/orchestrator/domain/check_results/check_suite.py                                    25     25      0      0   0.00%   3-67
core/orchestrator/domain/check_results/dryrun_result.py                                  19     19      0      0   0.00%   3-37
core/orchestrator/domain/check_results/lint_result.py                                    19     19      0      0   0.00%   3-37
core/orchestrator/domain/check_results/policy_result.py                                  19     19      0      0   0.00%   3-37
core/orchestrator/domain/check_results/result.py                                          9      9      0      0   0.00%   3-36
core/orchestrator/domain/check_results/services/scoring.py                               16     16      0      0   0.00%   1-82
core/orchestrator/domain/deliberation_result.py                                          27     27      2      0   0.00%   3-72
core/orchestrator/domain/tasks/services/task_selection_service.py                        17     17      2      0   0.00%   3-69
core/orchestrator/domain/tasks/task.py                                                   15     15      0      0   0.00%   3-43
core/orchestrator/domain/tasks/task_constraints.py                                       27     27      4      0   0.00%   3-56
core/orchestrator/domain/tasks/task_execution.py                                         23     23      0      0   0.00%   3-56
core/orchestrator/domain/tasks/task_spec.py                                              14     14      0      0   0.00%   3-42
core/orchestrator/domain/tasks/task_status.py                                            30     30      0      0   0.00%   3-96
core/orchestrator/dto/agent_job_event_dto.py                                             16     16      0      0   0.00%   3-38
core/orchestrator/dto/execution_response_dto.py                                          36     36      6      0   0.00%   3-99
core/orchestrator/usecases/deliberate_async_usecase.py                                   54     54     10      0   0.00%   2-246
core/orchestrator/usecases/dispatch_usecase.py                                           13     13      0      0   0.00%   3-44
core/orchestrator/usecases/orchestrate_usecase.py                                        15     15      0      0   0.00%   3-49
core/orchestrator/usecases/peer_deliberation_usecase.py                                  32     32     14      0   0.00%   4-87
core/reports/adapters/neo4j_decision_graph_read_adapter.py                               63     63     10      0   0.00%   1-159
core/reports/adapters/neo4j_graph_analytics_read_adapter.py                              54     54     18      0   0.00%   1-127
core/reports/adapters/neo4j_query_store.py                                               38     38      6      0   0.00%   1-54
core/reports/decision_enriched_report.py                                                146    146     66      0   0.00%   1-269
core/reports/domain/decision_enriched_report.py                                           9      9      0      0   0.00%   1-11
core/reports/domain/report_request.py                                                    11     11      0      0   0.00%   1-13
core/reports/ports/decision_graph_read_port.py                                            5      5      0      0   0.00%   1-6
core/reports/ports/graph_analytics_read_port.py                                           3      3      0      0   0.00%   1-5
core/reports/report_usecase.py                                                          117    117     48      0   0.00%   1-186
core/agents_and_tools/tools/validators.py                                                80     67     52      0   9.85%   23, 40-54, 71-90, 107-120, 136-155, 172-189, 206-214, 231-246, 261-268
core/agents_and_tools/tools/domain/docker_result.py                                     109     78     44      0  20.26%   44-54, 63, 72, 81-86, 100-115, 119, 123-127, 131, 135-138, 142, 146, 150, 164-177, 181-188, 192-205, 209-216, 220-228, 232-240
core/agents_and_tools/tools/git_tool.py                                                 169    122     72      1  20.75%   81, 85-86, 111-155, 179-193, 205-209, 221-233, 246-254, 270-280, 293-298, 311-318, 331-339, 352-361, 374-379, 383, 410-414, 419, 423, 437-455, 469-489, 517-523
core/agents_and_tools/tools/docker_tool.py                                              227    171     54      3  21.00%   67, 74->79, 83, 105-114, 128-137, 155-227, 248-263, 267-272, 276-278, 282-287, 291-293, 311-371, 395-446, 465-498, 522-572, 592-622, 642-678, 699, 723-727, 732, 736, 755, 774, 810-820
core/context/infrastructure/mappers/task_mapper.py                                       41     28     20      0  21.31%   30-47, 69-80, 98-108
core/agents_and_tools/tools/file_tool.py                                                283    211     90      7  21.72%   83, 87-88, 116->120, 120->124, 129-130, 144-153, 178-227, 250-278, 298-318, 340-397, 422-471, 494-546, 564-595, 614-631, 649-687, 721-741, 759-797, 817-878, 912, 918, 940-951, 965-972, 999-1019
core/agents_and_tools/tools/audit.py                                                    100     71     28      0  22.66%   52-58, 68-94, 98-103, 107-125, 129-158, 179-187, 198-208, 212-215, 225-231, 255-256, 267-270, 290-291
core/agents_and_tools/tools/db_tool.py                                                  128     88     22      0  28.00%   69-70, 99-163, 190-235, 268-311, 323, 343-347, 352, 356, 370-374, 388-393, 422-425, 458-461, 501-504
core/agents_and_tools/tools/domain/docker_operation_metadata.py                          54     29     22      0  32.89%   38-42, 54-75, 84, 93, 115, 135, 155
core/agents_and_tools/tools/domain/container_exec_config.py                              30     16     12      0  33.33%   30-43, 52, 61-63, 77, 92
core/agents_and_tools/tools/runner/runner_tool.py                                       153     91     32      0  33.51%   90-93, 97-113, 125-138, 142-188, 206-210, 223-262, 275-279, 291-301, 310, 322-324, 329-330, 335-337, 342-343, 348-349, 354-355
core/context/infrastructure/mappers/domain_event_mapper.py                               45     24     16      0  34.43%   29, 46, 64, 80, 103-106, 121-137, 149
core/agents_and_tools/tools/domain/container_logs_config.py                              37     19     14      0  35.29%   31-47, 56, 65, 76, 89, 103, 117
core/agents_and_tools/tools/domain/audit_record.py                                       30     15     12      0  35.71%   34-50, 62, 78, 87
core/context/utils.py                                                                    10      5      4      0  35.71%   26-30
core/agents_and_tools/tools/domain/container_run_config.py                               53     27     18      0  36.62%   36-62, 71, 80, 89, 98, 107, 116, 129, 143, 157
core/agents_and_tools/agents/application/usecases/execute_task_usecase.py               102     60     34      9  37.50%   80, 82, 84, 86, 88, 90, 92, 94, 96, 128-194, 216, 231, 247, 266-284, 303-338, 348-354
core/context/domain/value_objects/story_constraint.py                                    18      9      6      0  37.50%   22-29, 40, 48
core/context/infrastructure/mappers/graph_relationship_mapper.py                         20     11      4      0  37.50%   24, 48-60, 79-87
core/ray_jobs/infrastructure/adapters/nats_result_publisher.py                           33     17      8      0  39.02%   36-39, 43-47, 56-63, 72-79
core/agents_and_tools/tools/http_tool.py                                                109     58     26      1  40.00%   74, 91-92, 115-134, 163-239, 252, 256, 260, 264, 268, 272, 276, 299-303, 308, 312, 326-329, 343-351, 385-388
core/context/domain/value_objects/rehydration_stats.py                                   22     10      8      0  40.00%   21-28, 40, 54
core/reports/adapters/redis_planning_read_adapter.py                                    121     63     24      0  41.38%   30, 34, 38, 42, 57-61, 73-93, 105-123, 149, 163-202
core/agents_and_tools/tools/domain/container_build_config.py                             41     19     12      0  41.51%   34-50, 59, 68, 77, 86, 99, 113, 127
core/context/application/session_rehydration_service.py                                  80     43      8      0  42.05%   82-170, 197-269
core/agents_and_tools/agents/infrastructure/services/prompt_loader.py                    32     17      6      1  42.11%   27->30, 47-63, 75-76, 88-89, 102-104
core/context/application/rbac_context_service.py                                         79     43     18      1  42.27%   87-114, 141->exit, 169-204, 224-313, 357-390
core/agents_and_tools/tools/domain/container_stop_config.py                              19      8      6      0  44.00%   29-36, 49, 63
core/context/domain/value_objects/milestone.py                                           21      9      6      0  44.44%   29-32, 40, 51, 62-64
core/context/domain/subtask.py                                                           38     17      6      0  47.73%   27, 37, 48, 52, 62-80, 84, 94
core/agents_and_tools/tools/domain/container_remove_config.py                            27     11      6      0  48.48%   30-37, 46, 55, 68, 81, 94
core/agents_and_tools/tools/domain/audit_operation.py                                    32     13      6      0  50.00%   30-37, 46, 55, 64, 78, 95, 112, 128
core/context/domain/milestone_list.py                                                    18      7      4      0  50.00%   15-16, 20-24
core/agents_and_tools/agents/vllm_agent.py                                              135     61     30      8  50.91%   234, 236, 238, 240, 242, 244, 246, 334, 354, 421-424, 438, 457, 491-504, 523-552, 572-627, 712, 728-729, 748-763
core/context/domain/rehydration_bundle.py                                                25      9      6      0  51.61%   29-32, 46-48, 59, 67
core/context/infrastructure/mappers/epic_mapper.py                                       29     14      0      0  51.72%   29-38, 60-72, 91
core/context/adapters/neo4j_command_store.py                                            100     45      8      1  51.85%   58, 68, 89-93, 103-113, 161-162, 174-175, 187-188, 200-201, 213-217, 261-271, 296-305, 320-327
core/ray_jobs/infrastructure/adapters/vllm_http_client.py                                25     12      0      0  52.00%   57-87
core/context/infrastructure/mappers/rehydration_bundle_mapper.py                         21      9      2      0  52.17%   26, 51-64
core/agents_and_tools/agents/domain/entities/core/agent.py                               36     15      6      1  52.38%   61, 91, 111, 121, 131, 159-166, 187, 203-204, 216-217
core/agents_and_tools/agents/infrastructure/adapters/vllm_client_adapter.py              40     20      2      0  52.38%   90-125
core/agents_and_tools/agents/application/services/result_summarization_service.py        15      6      4      1  52.63%   32, 54-62
core/agents_and_tools/tools/domain/process_result.py                                     37     15     14      5  52.94%   32, 34, 36, 38, 40, 49, 58, 67, 76-81, 90
core/context/application/usecases/record_plan_approval.py                                13      6      0      0  53.85%   26, 35-47
core/context/application/usecases/synchronize_epic_from_planning.py                      13      6      0      0  53.85%   22, 31-42
core/context/application/usecases/synchronize_project_from_planning.py                   13      6      0      0  53.85%   37, 49-60
core/context/application/usecases/synchronize_story_from_planning.py                     13      6      0      0  53.85%   22, 31-42
core/context/application/usecases/synchronize_task_from_planning.py                      13      6      0      0  53.85%   22, 31-42
core/context/domain/plan_approval.py                                                     22      8      4      0  53.85%   30-33, 41, 49, 62, 70
core/context/domain/decision_relation_list.py                                            18      6      4      0  54.55%   17, 24-28
core/context/domain/decision_status.py                                                   16      6      2      0  55.56%   24, 35, 50-68
core/agents_and_tools/agents/infrastructure/adapters/yaml_profile_adapter.py             47     19     12      1  55.93%   23, 97-136
core/agents_and_tools/agents/application/services/artifact_collection_service.py         19      7      6      2  56.00%   38, 40, 61-73
core/agents_and_tools/tools/domain/docker_operations.py                                  28     10      4      0  56.25%   35-47, 59, 79-80, 92, 101, 110
core/context/usecases/project_decision.py                                                12      4      2      0  57.14%   15-19
core/context/domain/context_sections.py                                                  80     29     18      1  59.18%   41-42, 46-47, 51-52, 73, 95-97, 108-124, 128-130, 134-135, 139-140, 144, 148, 154
core/context/application/usecases/record_milestone.py                                    10      4      0      0  60.00%   24, 43-66
core/context/infrastructure/mappers/story_mapper.py                                      18      6      2      0  60.00%   32-39, 59, 75
core/agents_and_tools/tools/domain/container_list_config.py                              16      5      2      0  61.11%   28-29, 38, 48, 58
core/agents_and_tools/agents/application/services/log_reasoning_service.py               29     11      2      1  61.29%   41, 62, 87-88, 110, 131, 153, 179, 203, 231-242
core/context/domain/task.py                                                              27      8      4      0  61.29%   30-31, 39, 54-64, 72
core/context/domain/services/column_filter_service.py                                    28      9      6      1  64.71%   58-65, 96, 116-126
core/context/application/usecases/handle_story_phase_transition.py                       41     10     10      1  66.67%   98-120
core/context/domain/neo4j_config.py                                                      20      5     10      5  66.67%   27, 29, 31, 33, 35
core/context/domain/value_objects/decision_relation.py                                   13      3      2      0  66.67%   33-34, 42
core/context/usecases/project_plan_version.py                                            12      4      0      0  66.67%   28-35
core/ray_jobs/domain/vllm_response.py                                                    21      7      0      0  66.67%   53-68
core/ray_jobs/domain/agent_config.py                                                     38      8      8      1  67.39%   66, 113-120, 125
core/agents_and_tools/tools/domain/process_command.py                                    49     13     16      8  67.69%   35, 37, 39, 41, 43, 45, 47, 49, 53, 57, 73, 90, 129
core/ray_jobs/domain/execution_request.py                                                28      9      0      0  67.86%   54-56, 66, 70, 74, 78, 82, 86, 90
core/agents_and_tools/tools/domain/container_runtime.py                                  37     10     10      5  68.09%   34, 45, 54, 63, 83, 93, 114, 116, 119, 125
core/context/domain/value_objects/impacted_task.py                                       14      3      2      0  68.75%   32-33, 41
core/ray_jobs/domain/agent_task.py                                                       26      8      0      0  69.23%   46, 56, 60, 64, 68, 72, 76, 85
core/context/domain/task_plan.py                                                         33      8     10      5  69.77%   34, 36, 38, 40, 42, 50, 58, 69
core/context/domain/value_objects/context_section.py                                     16      4      4      2  70.00%   30, 32, 44, 52
core/context/domain/planning_event.py                                                    18      4      6      3  70.83%   27, 29, 31, 39
core/context/domain/services/decision_selector.py                                        19      4     10      2  72.41%   53-55, 61
core/context/domain/entity_ids/actor_id.py                                                9      2      2      1  72.73%   14, 21
core/context/usecases/project_task.py                                                    11      3      0      0  72.73%   28-32
core/context/domain/epic.py                                                              35      8      6      3  73.17%   54, 57, 61, 73, 81, 89, 100, 130
core/agents_and_tools/agents/infrastructure/mappers/artifact_mapper.py                   13      3      2      1  73.33%   33, 55, 78
core/context/domain/value_objects/acceptance_criteria.py                                 17      4      6      2  73.91%   18, 22, 42, 50
core/ray_jobs/infrastructure/adapters/ray_agent_executor.py                              29      7      2      1  74.19%   16, 18-20, 93-109
core/context/domain/role_context_fields.py                                               33      7      2      0  74.29%   44, 48, 52, 56, 67-69
core/agents_and_tools/agents/application/dtos/next_action_dto.py                         12      2      4      2  75.00%   25, 27
core/context/domain/value_objects/story_tags.py                                          20      5      4      1  75.00%   19, 40, 48, 56, 67
core/context/domain/value_objects/role_visibility_policy.py                              67     13     18      2  75.29%   81, 89, 117, 124, 131-133, 137-139, 143-145
core/context/domain/value_objects/story_constraints.py                                   20      4      2      1  77.27%   23, 32, 64, 75
core/context/domain/decision.py                                                          18      4      0      0  77.78%   24, 33, 42, 49
core/context/domain/events/plan_versioned_event.py                                       16      2      2      0  77.78%   30-31
core/context/domain/plan_version.py                                                      32      6      4      2  77.78%   38, 40, 48, 56, 64, 72
core/context/domain/story_header.py                                                      16      2      2      0  77.78%   31-32
core/ray_jobs/application/execute_agent_task.py                                          49      9      6      1  78.18%   74, 121-154
core/context/domain/value_objects/indexed_story_data.py                                  28      6      0      0  78.57%   52, 63, 74, 85, 93, 101
core/context/infrastructure/config/neo4j_config_loader.py                                12      2      2      1  78.57%   34, 57
core/context/domain/story.py                                                             18      3      6      2  79.17%   44, 51, 63
core/context/domain/story_spec.py                                                        23      3      6      3  79.31%   34, 36, 38
core/agents_and_tools/common/infrastructure/mappers/db_result_mapper.py                   5      1      0      0  80.00%   12
core/agents_and_tools/common/infrastructure/mappers/docker_result_mapper.py               5      1      0      0  80.00%   12
core/agents_and_tools/common/infrastructure/mappers/git_result_mapper.py                  5      1      0      0  80.00%   12
core/agents_and_tools/common/infrastructure/mappers/http_result_mapper.py                 5      1      0      0  80.00%   12
core/context/domain/value_objects/data_access_log_entry.py                               37      7      8      0  80.00%   85, 93-107
core/context/usecases/project_story.py                                                   10      2      0      0  80.00%   30-33
core/context/domain/get_role_based_context_request.py                                    28      5      8      2  80.56%   44, 47, 55, 63, 71
core/reports/domain/decision_node.py                                                     17      2      4      2  80.95%   31, 33
core/agents_and_tools/agents/application/dtos/plan_dto.py                                 9      1      2      1  81.82%   24
core/context/domain/entity_ids/decision_id.py                                             9      1      2      1  81.82%   14
core/context/domain/entity_ids/plan_id.py                                                 9      1      2      1  81.82%   14
core/context/domain/entity_ids/task_id.py                                                 9      1      2      1  81.82%   14
core/context/domain/context_section_type.py                                              28      5      0      0  82.14%   50, 61, 73, 85-116
core/context/infrastructure/mappers/task_plan_mapper.py                                  17      3      0      0  82.35%   37-38, 67
core/agents_and_tools/agents/application/usecases/generate_next_action_usecase.py        45      5     12      5  82.46%   50, 52, 54, 56, 110
core/ray_jobs/domain/vllm_request.py                                                     23      4      0      0  82.61%   15, 56, 65, 74
core/agents_and_tools/agents/application/dtos/step_execution_dto.py                      10      1      2      1  83.33%   24
core/agents_and_tools/agents/infrastructure/adapters/profile_config.py                   10      1      2      1  83.33%   32
core/context/domain/epic_status.py                                                       12      2      0      0  83.33%   33, 45
core/agents_and_tools/agents/infrastructure/dtos/agent_initialization_config.py          19      2      6      2  84.00%   40, 43
core/agents_and_tools/agents/application/usecases/generate_plan_usecase.py               42      4     10      4  84.62%   50, 52, 54, 56
core/context/domain/value_objects/task_impact.py                                         11      1      2      1  84.62%   30
core/context/infrastructure/mappers/story_header_mapper.py                               13      2      0      0  84.62%   28, 48
core/reports/domain/decision_edges.py                                                    11      1      2      1  84.62%   27
core/reports/domain/task_node.py                                                         11      1      2      1  84.62%   27
core/context/infrastructure/mappers/planning_event_mapper.py                             40      6      0      0  85.00%   89, 101, 113, 122, 133, 143
core/agents_and_tools/agents/infrastructure/mappers/agent_profile_mapper.py               7      1      0      0  85.71%   22
core/context/domain/plan_header.py                                                       15      2      0      0  86.67%   18, 26
core/context/domain/graph_relationship.py                                                24      3      0      0  87.50%   44, 63, 82
core/context/infrastructure/mappers/role_context_fields_mapper.py                         8      1      0      0  87.50%   23
core/context/domain/services/authorization_checker.py                                    41      4     18      1  88.14%   62-67, 131
core/agents_and_tools/agents/domain/entities/collections/artifacts.py                    23      2      4      1  88.89%   47-48
core/context/domain/milestone_event_type.py                                              19      2      0      0  89.47%   45, 59
core/context/domain/decision_relation.py                                                 10      1      0      0  90.00%   14
core/context/domain/milestone.py                                                         10      1      0      0  90.00%   14
core/context/domain/task_status.py                                                       20      2      0      0  90.00%   46, 59
core/agents_and_tools/agents/infrastructure/adapters/tool_factory.py                    133     12     42      5  90.29%   179-182, 297-300, 319->314, 343-345, 350, 397, 400->405, 407-408
core/agents_and_tools/common/domain/entities/agent_capabilities.py                       19      1      2      1  90.48%   42
core/agents_and_tools/agents/domain/entities/rbac/role.py                                49      5      4      0  90.57%   172, 182, 192, 196, 200
core/agents_and_tools/agents/application/usecases/execute_task_iterative_usecase.py     130      8     42      7  91.28%   89, 91, 93, 95, 97, 300->331, 356-363
core/context/infrastructure/mappers/plan_version_mapper.py                               22      2      2      0  91.67%   64, 80
core/context/infrastructure/mappers/story_spec_mapper.py                                 14      1      0      0  92.86%   51
core/ray_jobs/domain/agent_role.py                                                       14      1      0      0  92.86%   52
core/ray_jobs/infrastructure/ray_agent_factory.py                                        27      1      4      1  93.55%   100
core/ray_jobs/domain/system_prompt.py                                                    29      2      6      0  94.29%   83, 92
core/context/domain/project.py                                                           32      2      4      0  94.44%   91, 121
core/context/adapters/neo4j_query_store.py                                               35      1      6      1  95.12%   88
core/context/adapters/redis_planning_read_adapter.py                                     72      2     10      2  95.12%   53, 72
core/agents_and_tools/agents/infrastructure/factories/vllm_agent_factory.py              45      1      2      1  95.74%   85
core/ray_jobs/domain/agent_result.py                                                     56      1     20      2  96.05%   118->120, 120->122, 137
core/shared/domain/action.py                                                             34      1      0      0  97.06%   49
core/reports/dtos/dtos.py                                                                43      1      0      0  97.67%   32
core/agents_and_tools/common/domain/entities/tool_registry.py                            40      1     12      0  98.08%   149
core/context/application/usecases/process_context_change.py                              53      0     14      1  98.51%   90->98
core/agents_and_tools/agents/application/services/step_execution_service.py              34      0      8      0 100.00%
core/agents_and_tools/agents/application/usecases/collect_artifacts_usecase.py           18      0      6      0 100.00%
core/agents_and_tools/agents/application/usecases/load_profile_usecase.py                 9      0      0      0 100.00%
core/agents_and_tools/agents/application/usecases/log_reasoning_usecase.py               20      0     10      0 100.00%
core/agents_and_tools/agents/application/usecases/summarize_result_usecase.py            12      0      4      0 100.00%
core/agents_and_tools/agents/domain/entities/collections/artifact.py                      7      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/collections/audit_trail.py                  10      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/collections/audit_trails.py                 18      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/collections/observation_histories.py        22      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/collections/observation_history.py          10      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/collections/operations.py                   22      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/collections/reasoning_log.py                12      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/collections/reasoning_logs.py               19      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/core/agent_id.py                             7      0      2      0 100.00%
core/agents_and_tools/agents/domain/entities/core/agent_profile.py                       19      0     10      0 100.00%
core/agents_and_tools/agents/domain/entities/core/agent_result.py                        13      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/core/agent_thought.py                        9      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/core/execution_constraints.py                8      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/core/execution_plan.py                       5      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/core/execution_step.py                      12      0      4      0 100.00%
core/agents_and_tools/agents/domain/entities/core/operation.py                           13      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/core/tool_type.py                           14      0      4      0 100.00%
core/agents_and_tools/agents/domain/entities/rbac/role_factory.py                        28      0      2      0 100.00%
core/agents_and_tools/agents/domain/entities/results/db_execution_result.py               8      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/results/docker_execution_result.py           9      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/results/file_execution_result.py             6      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/results/git_execution_result.py              9      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/results/http_execution_result.py             9      0      0      0 100.00%
core/agents_and_tools/agents/domain/entities/results/step_execution_result.py             9      0      0      0 100.00%
core/agents_and_tools/agents/domain/ports/llm_client.py                                   2      0      0      0 100.00%
core/agents_and_tools/agents/domain/ports/profile_loader_port.py                          3      0      0      0 100.00%
core/agents_and_tools/agents/infrastructure/adapters/tool_execution_adapter.py           22      0      0      0 100.00%
core/agents_and_tools/agents/infrastructure/dtos/agent_profile_dto.py                     8      0      0      0 100.00%
core/agents_and_tools/agents/infrastructure/mappers/execution_step_mapper.py             10      0      0      0 100.00%
core/agents_and_tools/agents/infrastructure/services/json_response_parser.py             25      0      4      0 100.00%
core/agents_and_tools/common/domain/entities/capability.py                               15      0      4      0 100.00%
core/agents_and_tools/common/domain/entities/capability_collection.py                    36      0      4      0 100.00%
core/agents_and_tools/common/domain/entities/execution_mode.py                           16      0      0      0 100.00%
core/agents_and_tools/common/domain/entities/tool_definition.py                          17      0      4      0 100.00%
core/agents_and_tools/common/domain/ports/tool_execution_port.py                          6      0      0      0 100.00%
core/agents_and_tools/common/infrastructure/mappers/file_result_mapper.py                 5      0      0      0 100.00%
core/agents_and_tools/tools/domain/process_executor.py                                    7      0      0      0 100.00%
core/agents_and_tools/tools/ports/event_bus_port.py                                       8      0      0      0 100.00%
core/context/application/usecases/publish_context_updated.py                             17      0      4      0 100.00%
core/context/application/usecases/publish_rehydrate_session_response.py                  18      0      4      0 100.00%
core/context/application/usecases/publish_update_context_response.py                     18      0      4      0 100.00%
core/context/domain/decision_kind.py                                                     23      0      0      0 100.00%
core/context/domain/domain_event.py                                                       6      0      0      0 100.00%
core/context/domain/entity_ids/epic_id.py                                                 9      0      2      0 100.00%
core/context/domain/entity_ids/project_id.py                                              9      0      2      0 100.00%
core/context/domain/entity_ids/story_id.py                                                9      0      2      0 100.00%
core/context/domain/entity_type.py                                                       14      0      0      0 100.00%
core/context/domain/event_type.py                                                        13      0      0      0 100.00%
core/context/domain/events/decision_made_event.py                                        17      0      0      0 100.00%
core/context/domain/events/story_created_event.py                                        11      0      0      0 100.00%
core/context/domain/events/task_created_event.py                                         17      0      0      0 100.00%
core/context/domain/events/task_status_changed_event.py                                  16      0      0      0 100.00%
core/context/domain/graph_label.py                                                        9      0      0      0 100.00%
core/context/domain/graph_relation_type.py                                               14      0      0      0 100.00%
core/context/domain/neo4j_queries.py                                                     25      0      0      0 100.00%
core/context/domain/phase_transition.py                                                  23      0      6      0 100.00%
core/context/domain/project_status.py                                                    13      0      0      0 100.00%
core/context/domain/rehydration_request.py                                               10      0      0      0 100.00%
core/context/domain/role.py                                                              20      0      0      0 100.00%
core/context/domain/services/data_indexer.py                                             33      0     14      0 100.00%
core/context/domain/services/impact_calculator.py                                        16      0      6      0 100.00%
core/context/domain/services/token_budget_calculator.py                                  21      0      4      0 100.00%
core/context/domain/task_type.py                                                         20      0      0      0 100.00%
core/context/domain/value_objects/authorization_result.py                                26      0      8      0 100.00%
core/context/domain/value_objects/column_policy.py                                       19      0      8      0 100.00%
core/context/infrastructure/mappers/project_mapper.py                                    17      0      0      0 100.00%
core/context/ports/data_access_audit_port.py                                              2      0      0      0 100.00%
core/context/ports/decisiongraph_read_port.py                                             6      0      0      0 100.00%
core/context/ports/graph_command_port.py                                                  7      0      0      0 100.00%
core/context/ports/graph_query_port.py                                                    3      0      0      0 100.00%
core/context/ports/messaging_port.py                                                      3      0      0      0 100.00%
core/context/ports/planning_read_port.py                                                  4      0      0      0 100.00%
core/context/ports/story_authorization_port.py                                            3      0      0      0 100.00%
core/memory/dtos/llm_call_dto.py                                                         12      0      0      0 100.00%
core/memory/dtos/llm_response_dto.py                                                     11      0      0      0 100.00%
core/memory/ports/persistence_kv_port.py                                                  3      0      0      0 100.00%
core/memory/ports/persistence_pipeline_port.py                                            2      0      0      0 100.00%
core/ray_jobs/application/generate_proposal.py                                           14      0      0      0 100.00%
core/ray_jobs/domain/ports/i_async_executor.py                                            5      0      0      0 100.00%
core/ray_jobs/domain/ports/i_llm_client.py                                                4      0      0      0 100.00%
core/ray_jobs/domain/ports/i_result_publisher.py                                          3      0      0      0 100.00%
core/ray_jobs/domain/ports/i_vllm_client.py                                               4      0      0      0 100.00%
core/ray_jobs/domain/task_prompt.py                                                      19      0      4      0 100.00%
core/ray_jobs/infrastructure/adapters/asyncio_executor.py                                 8      0      0      0 100.00%
core/reports/domain/graph_analytics_types.py                                             24      0      0      0 100.00%
core/reports/domain/report.py                                                             9      0      0      0 100.00%
core/reports/ports/planning_read_port.py                                                  3      0      0      0 100.00%
core/shared/domain/action_enum.py                                                        38      0      0      0 100.00%
core/shared/domain/action_scopes.py                                                       3      0      0      0 100.00%
core/shared/domain/scope_enum.py                                                          8      0      0      0 100.00%
core/shared/domain/value_objects/content/task_description.py                              9      0      4      0 100.00%
core/shared/domain/value_objects/task_attributes/duration.py                             19      0      6      0 100.00%
core/shared/domain/value_objects/task_attributes/priority.py                             21      0      6      0 100.00%
core/shared/domain/value_objects/task_derivation/config/task_derivation_config.py        19      0      8      0 100.00%
core/shared/domain/value_objects/task_derivation/keyword.py                              11      0      4      0 100.00%
----------------------------------------------------------------------------------------------------------------------------------
TOTAL                                                                                  8183   3450   1684    147  53.25%
Coverage HTML written to dir htmlcov
Coverage JSON written to file coverage.json
================= 948 passed, 28 skipped, 11 warnings in 8.05s =================

ðŸ”§ Running service tests...
============================= test session starts ==============================
platform linux -- Python 3.13.7, pytest-8.4.2, pluggy-1.6.0
rootdir: /home/tirso/ai/developents/swe-ai-fleet
configfile: pytest.ini
plugins: anyio-4.11.0, cov-7.0.0, asyncio-1.2.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 1726 items / 5 deselected / 1721 selected

services/context/tests/unit/consumers/planning/test_base_consumer.py ... [  0%]
..........                                                               [  0%]
services/context/tests/unit/consumers/planning/test_epic_created_consumer.py . [  0%]
.....                                                                    [  1%]
services/context/tests/unit/consumers/planning/test_plan_approved_consumer.py . [  1%]
......                                                                   [  1%]
services/context/tests/unit/consumers/planning/test_project_created_consumer.py . [  1%]
....                                                                     [  1%]
services/context/tests/unit/consumers/planning/test_story_created_consumer.py . [  1%]
....                                                                     [  2%]
services/context/tests/unit/consumers/planning/test_story_transitioned_consumer.py . [  2%]
.....                                                                    [  2%]
services/context/tests/unit/consumers/planning/test_task_created_consumer.py . [  2%]
.....                                                                    [  2%]
services/context/tests/unit/consumers/test_planning_consumer.py .......  [  3%]
services/context/tests/unit/infrastructure/adapters/test_internal_servicer_context.py . [  3%]
.........                                                                [  3%]
services/context/tests/unit/infrastructure/adapters/test_nats_messaging_adapter.py . [  3%]
......                                                                   [  4%]
services/context/tests/unit/infrastructure/adapters/test_servicer_context_error_handler.py . [  4%]
...                                                                      [  4%]
services/context/tests/unit/infrastructure/adapters/test_servicer_error.py . [  4%]
.....                                                                    [  4%]
services/context/tests/unit/test_connection_state_base.py .............  [  5%]
services/context/tests/unit/test_nats_handler.py ....................... [  6%]
                                                                         [  6%]
services/context/tests/unit/test_server.py ....                          [  7%]
services/context/tests/unit/test_utils.py .............................. [  8%]
..........                                                               [  9%]
services/monitoring/tests/application/usecases/orchestrator/test_check_orchestrator_connection_usecase.py . [  9%]
........                                                                 [  9%]
services/monitoring/tests/application/usecases/orchestrator/test_get_councils_info_usecase.py . [  9%]
.........                                                                [ 10%]
services/monitoring/tests/application/usecases/orchestrator/test_get_orchestrator_info_usecase.py . [ 10%]
......                                                                   [ 10%]
services/monitoring/tests/domain/entities/events/test_monitoring_event.py . [ 10%]
....                                                                     [ 11%]
services/monitoring/tests/domain/entities/orchestrator/test_agent_info.py . [ 11%]
....................                                                     [ 12%]
services/monitoring/tests/domain/entities/orchestrator/test_council_info.py . [ 12%]
................................                                         [ 14%]
services/monitoring/tests/domain/entities/orchestrator/test_orchestrator_connection_status.py . [ 14%]
............................                                             [ 16%]
services/monitoring/tests/domain/entities/orchestrator/test_orchestrator_info.py . [ 16%]
...................................                                      [ 18%]
services/monitoring/tests/domain/entities/test_durable_consumer.py ..... [ 18%]
.....                                                                    [ 18%]
services/monitoring/tests/domain/entities/test_fetch_request.py ........ [ 19%]
....                                                                     [ 19%]
services/monitoring/tests/domain/entities/test_messages_collection.py .. [ 19%]
....                                                                     [ 19%]
services/monitoring/tests/domain/entities/test_pull_subscribe_request.py . [ 19%]
...........                                                              [ 20%]
services/monitoring/tests/domain/entities/test_push_subscribe_request.py . [ 20%]
..........                                                               [ 21%]
services/monitoring/tests/domain/entities/test_stream_info.py .....      [ 21%]
services/monitoring/tests/domain/entities/test_stream_info_extended.py . [ 21%]
......                                                                   [ 21%]
services/monitoring/tests/domain/entities/test_stream_message.py .....   [ 22%]
services/monitoring/tests/domain/entities/test_stream_name.py .......... [ 22%]
......                                                                   [ 23%]
services/monitoring/tests/domain/entities/test_stream_query.py .......   [ 23%]
services/monitoring/tests/domain/entities/test_subscribe_request.py .... [ 23%]
...                                                                      [ 23%]
services/monitoring/tests/domain/ports/orchestrator/test_orchestrator_query_port.py . [ 23%]
.....                                                                    [ 24%]
services/monitoring/tests/infrastructure/adapters/test_nats_connection_adapter.py . [ 24%]
......                                                                   [ 24%]
services/monitoring/tests/infrastructure/adapters/test_nats_stream_adapter.py . [ 24%]
..........                                                               [ 25%]
services/monitoring/tests/infrastructure/orchestrator_connectors/grpc/adapters/test_grpc_orchestrator_query_adapter.py . [ 25%]
........                                                                 [ 25%]
services/monitoring/tests/infrastructure/orchestrator_connectors/grpc/mappers/test_agent_info_mapper.py . [ 25%]
............                                                             [ 26%]
services/monitoring/tests/infrastructure/test_mappers.py ........        [ 26%]
services/monitoring/tests/sources/test_monitoring_sources_correct.py ... [ 27%]
.............                                                            [ 27%]
services/monitoring/tests/sources/test_neo4j_source.py ..........        [ 28%]
services/monitoring/tests/test_nats_source.py ........                   [ 28%]
services/orchestrator/tests/application/test_delete_council_usecase.py . [ 28%]
...                                                                      [ 29%]
services/orchestrator/tests/application/test_deliberate_async_fix.py ... [ 29%]
.                                                                        [ 29%]
services/orchestrator/tests/application/test_deliberate_usecase.py ..... [ 29%]
.                                                                        [ 29%]
services/orchestrator/tests/application/test_list_councils_usecase.py .. [ 29%]
.                                                                        [ 29%]
services/orchestrator/tests/application/usecases/test_list_councils_usecase.py . [ 29%]
.....                                                                    [ 30%]
services/orchestrator/tests/domain/entities/test_service_configuration.py . [ 30%]
.........                                                                [ 30%]
services/orchestrator/tests/domain/ports/test_scoring_port.py ........   [ 31%]
services/orchestrator/tests/domain/test_agent_collection.py ............ [ 32%]
                                                                         [ 32%]
services/orchestrator/tests/domain/test_agent_config.py .....            [ 32%]
services/orchestrator/tests/domain/test_agent_type.py ....               [ 32%]
services/orchestrator/tests/domain/test_check_suite.py ........          [ 33%]
services/orchestrator/tests/domain/test_council_registry.py ............ [ 33%]
.                                                                        [ 33%]
services/orchestrator/tests/domain/test_deliberation_result_data.py .... [ 33%]
.......                                                                  [ 34%]
services/orchestrator/tests/domain/test_deliberation_tracker_port.py ... [ 34%]
.                                                                        [ 34%]
services/orchestrator/tests/domain/test_messaging_port.py .......        [ 35%]
services/orchestrator/tests/domain/test_role_collection.py .....         [ 35%]
services/orchestrator/tests/domain/test_service_configuration.py .....   [ 35%]
services/orchestrator/tests/domain/test_statistics.py ......             [ 35%]
services/orchestrator/tests/infrastructure/adapters/test_nats_messaging_adapter_basic.py . [ 36%]
........                                                                 [ 36%]
services/orchestrator/tests/infrastructure/handlers/test_agent_response_consumer.py . [ 36%]
...                                                                      [ 36%]
services/orchestrator/tests/infrastructure/handlers/test_deliberation_collector.py . [ 36%]
....                                                                     [ 37%]
services/orchestrator/tests/infrastructure/handlers/test_orchestrator_handlers.py . [ 37%]
...............                                                          [ 37%]
services/orchestrator/tests/infrastructure/handlers/test_planning_consumer.py . [ 38%]
.....                                                                    [ 38%]
services/orchestrator/tests/infrastructure/test_council_info_mapper.py . [ 38%]
....                                                                     [ 38%]
services/orchestrator/tests/infrastructure/test_council_query_adapter.py . [ 38%]
.......                                                                  [ 39%]
services/orchestrator/tests/infrastructure/test_deliberate_council_factory_adapter.py . [ 39%]
..                                                                       [ 39%]
services/orchestrator/tests/infrastructure/test_deliberation_status_mapper.py . [ 39%]
.......                                                                  [ 39%]
services/orchestrator/tests/infrastructure/test_environment_configuration_adapter.py . [ 39%]
...                                                                      [ 39%]
services/orchestrator/tests/infrastructure/test_vllm_agent_factory_adapter.py . [ 39%]
.                                                                        [ 40%]
services/orchestrator/tests/test_server.py ................              [ 40%]
services/planning/tests/unit/application/test_approve_decision_usecase.py . [ 41%]
....                                                                     [ 41%]
services/planning/tests/unit/application/test_create_epic_usecase.py ... [ 41%]
....                                                                     [ 41%]
services/planning/tests/unit/application/test_create_project_usecase.py . [ 41%]
.......                                                                  [ 42%]
services/planning/tests/unit/application/test_create_story_usecase.py .. [ 42%]
....                                                                     [ 42%]
services/planning/tests/unit/application/test_create_task_usecase.py ... [ 42%]
.....                                                                    [ 42%]
services/planning/tests/unit/application/test_derive_tasks_from_plan_usecase.py . [ 42%]
..                                                                       [ 43%]
services/planning/tests/unit/application/test_get_project_usecase.py ... [ 43%]
.                                                                        [ 43%]
services/planning/tests/unit/application/test_list_projects_usecase.py . [ 43%]
.........                                                                [ 43%]
services/planning/tests/unit/application/test_list_stories_usecase.py .. [ 44%]
.....                                                                    [ 44%]
services/planning/tests/unit/application/test_reject_decision_usecase.py . [ 44%]
....                                                                     [ 44%]
services/planning/tests/unit/application/test_task_derivation_result_service.py . [ 44%]
.......                                                                  [ 45%]
services/planning/tests/unit/application/test_transition_story_usecase.py . [ 45%]
.....                                                                    [ 45%]
services/planning/tests/unit/domain/test_brief.py .........              [ 45%]
services/planning/tests/unit/domain/test_comment.py ..........           [ 46%]
services/planning/tests/unit/domain/test_decision_id.py ........         [ 47%]
services/planning/tests/unit/domain/test_dependency_graph.py ........... [ 47%]
...........                                                              [ 48%]
services/planning/tests/unit/domain/test_dependency_inference.py ....... [ 48%]
...............                                                          [ 49%]
services/planning/tests/unit/domain/test_dor_score.py ..........         [ 50%]
services/planning/tests/unit/domain/test_fsm_validation.py .......       [ 50%]
services/planning/tests/unit/domain/test_reason.py .........             [ 51%]
services/planning/tests/unit/domain/test_role_mapper.py ..........       [ 51%]
services/planning/tests/unit/domain/test_story.py ................       [ 52%]
services/planning/tests/unit/domain/test_story_id.py ......              [ 52%]
services/planning/tests/unit/domain/test_story_list.py ..........        [ 53%]
services/planning/tests/unit/domain/test_story_state.py ................ [ 54%]
.                                                                        [ 54%]
services/planning/tests/unit/domain/test_story_state_carry_over.py ..... [ 54%]
.....                                                                    [ 55%]
services/planning/tests/unit/domain/test_story_state_planned.py ........ [ 55%]
.......                                                                  [ 55%]
services/planning/tests/unit/domain/test_title.py .........              [ 56%]
services/planning/tests/unit/domain/test_user_name.py .........          [ 57%]
services/planning/tests/unit/infrastructure/adapters/test_planning_context_service_adapter.py . [ 57%]
........                                                                 [ 57%]
services/planning/tests/unit/infrastructure/consumers/test_plan_approved_consumer.py . [ 57%]
............                                                             [ 58%]
services/planning/tests/unit/infrastructure/consumers/test_task_derivation_result_consumer.py . [ 58%]
................                                                         [ 59%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_approve_decision_handler.py . [ 59%]
..                                                                       [ 59%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_create_epic_handler.py . [ 59%]
..                                                                       [ 59%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_create_project_handler.py . [ 59%]
..                                                                       [ 59%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_create_story_handler.py . [ 59%]
..                                                                       [ 59%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_create_task_handler.py . [ 60%]
..                                                                       [ 60%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_get_epic_handler.py . [ 60%]
..                                                                       [ 60%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_get_project_handler.py . [ 60%]
..                                                                       [ 60%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_get_story_handler.py . [ 60%]
..                                                                       [ 60%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_get_task_handler.py . [ 60%]
..                                                                       [ 60%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_list_epics_handler.py . [ 60%]
..                                                                       [ 61%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_list_projects_handler.py . [ 61%]
.........                                                                [ 61%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_list_stories_handler.py . [ 61%]
...                                                                      [ 61%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_list_tasks_handler.py . [ 61%]
..                                                                       [ 61%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_reject_decision_handler.py . [ 62%]
..                                                                       [ 62%]
services/planning/tests/unit/infrastructure/grpc/handlers/test_transition_story_handler.py . [ 62%]
..                                                                       [ 62%]
services/planning/tests/unit/infrastructure/mappers/test_context_grpc_mapper.py . [ 62%]
..........                                                               [ 62%]
services/planning/tests/unit/infrastructure/mappers/test_project_neo4j_mapper.py . [ 63%]
.............                                                            [ 63%]
services/planning/tests/unit/infrastructure/test_environment_config_adapter.py . [ 63%]
.............                                                            [ 64%]
services/planning/tests/unit/infrastructure/test_event_payload_mapper.py . [ 64%]
.....                                                                    [ 64%]
services/planning/tests/unit/infrastructure/test_llm_task_derivation_mapper.py . [ 65%]
.....                                                                    [ 65%]
services/planning/tests/unit/infrastructure/test_nats_messaging_adapter.py . [ 65%]
.....                                                                    [ 65%]
services/planning/tests/unit/infrastructure/test_neo4j_adapter.py ...    [ 65%]
services/planning/tests/unit/infrastructure/test_neo4j_adapter_projects.py . [ 65%]
.........                                                                [ 66%]
services/planning/tests/unit/infrastructure/test_neo4j_adapter_unit.py . [ 66%]
........................                                                 [ 67%]
services/planning/tests/unit/infrastructure/test_neo4j_queries.py ...... [ 68%]
.....                                                                    [ 68%]
services/planning/tests/unit/infrastructure/test_project_valkey_mapper.py . [ 68%]
........                                                                 [ 69%]
services/planning/tests/unit/infrastructure/test_response_protobuf_mapper.py . [ 69%]
.........                                                                [ 69%]
services/planning/tests/unit/infrastructure/test_storage_adapter.py .... [ 69%]
.................                                                        [ 70%]
services/planning/tests/unit/infrastructure/test_story_protobuf_mapper.py . [ 70%]
.                                                                        [ 70%]
services/planning/tests/unit/infrastructure/test_story_valkey_mapper.py . [ 71%]
....                                                                     [ 71%]
services/planning/tests/unit/infrastructure/test_valkey_adapter.py ...   [ 71%]
services/planning/tests/unit/infrastructure/test_valkey_adapter_projects.py . [ 71%]
..........                                                               [ 72%]
services/planning/tests/unit/infrastructure/test_valkey_adapter_unit.py . [ 72%]
.......................                                                  [ 73%]
services/planning/tests/unit/infrastructure/test_valkey_keys.py ........ [ 73%]
.....                                                                    [ 74%]
services/planning/tests/unit/test_server.py .................            [ 75%]
services/ray_executor/tests/unit/test_domain_entities.py ..............  [ 76%]
services/ray_executor/tests/unit/test_execute_deliberation_usecase.py .. [ 76%]
...                                                                      [ 76%]
services/ray_executor/tests/unit/test_get_active_jobs_usecase.py ....... [ 76%]
..                                                                       [ 76%]
services/ray_executor/tests/unit/test_get_deliberation_status_usecase.py . [ 76%]
......                                                                   [ 77%]
services/ray_executor/tests/unit/test_get_stats_usecase.py ...           [ 77%]
services/task_derivation/tests/unit/application/ports/test_ports_imports.py . [ 77%]
                                                                         [ 77%]
services/task_derivation/tests/unit/application/usecases/test_derive_tasks_usecase.py . [ 77%]
                                                                         [ 77%]
services/task_derivation/tests/unit/application/usecases/test_process_task_derivation_result_usecase.py . [ 77%]
.                                                                        [ 77%]
services/task_derivation/tests/unit/domain/events/test_task_derivation_events.py . [ 77%]
.........                                                                [ 78%]
services/task_derivation/tests/unit/domain/value_objects/test_context_role.py . [ 78%]
.                                                                        [ 78%]
services/task_derivation/tests/unit/domain/value_objects/test_core_value_objects.py . [ 78%]
.......                                                                  [ 78%]
services/task_derivation/tests/unit/domain/value_objects/test_dependency_edge.py . [ 78%]
                                                                         [ 78%]
services/task_derivation/tests/unit/domain/value_objects/test_dependency_graph.py . [ 78%]
...........                                                              [ 79%]
services/task_derivation/tests/unit/domain/value_objects/test_dependency_inference_helper.py . [ 79%]
................                                                         [ 80%]
services/task_derivation/tests/unit/domain/value_objects/test_derivation_phase.py . [ 80%]
..                                                                       [ 80%]
services/task_derivation/tests/unit/domain/value_objects/test_derivation_request_id.py . [ 80%]
.                                                                        [ 80%]
services/task_derivation/tests/unit/domain/value_objects/test_executor_role.py . [ 80%]
.                                                                        [ 80%]
services/task_derivation/tests/unit/domain/value_objects/test_plan_content_vos.py . [ 80%]
.............                                                            [ 81%]
services/task_derivation/tests/unit/domain/value_objects/test_plan_context.py . [ 81%]
.                                                                        [ 81%]
services/task_derivation/tests/unit/domain/value_objects/test_task_creation_command.py . [ 81%]
.                                                                        [ 81%]
services/task_derivation/tests/unit/domain/value_objects/test_task_derivation_config.py . [ 82%]
.                                                                        [ 82%]
services/task_derivation/tests/unit/domain/value_objects/test_task_node.py . [ 82%]
.                                                                        [ 82%]
services/task_derivation/tests/unit/domain/value_objects/test_task_summary.py . [ 82%]
.                                                                        [ 82%]
services/task_derivation/tests/unit/infrastructure/adapters/test_context_service_adapter.py . [ 82%]
..........                                                               [ 82%]
services/task_derivation/tests/unit/infrastructure/adapters/test_planning_service_adapter.py . [ 83%]
...                                                                      [ 83%]
services/task_derivation/tests/unit/infrastructure/adapters/test_ray_executor_adapter.py . [ 83%]
...............                                                          [ 84%]
services/task_derivation/tests/unit/infrastructure/adapters/test_task_derivation_nats_messaging_adapter.py . [ 84%]
........                                                                 [ 84%]
services/task_derivation/tests/unit/infrastructure/consumers/test_task_derivation_request_consumer.py . [ 84%]
.......                                                                  [ 85%]
services/task_derivation/tests/unit/infrastructure/consumers/test_task_derivation_result_consumer.py . [ 85%]
..........                                                               [ 85%]
services/task_derivation/tests/unit/infrastructure/dto/test_plan_snapshot_dto.py . [ 85%]
........                                                                 [ 86%]
services/task_derivation/tests/unit/infrastructure/dto/test_task_derivation_payloads.py . [ 86%]
...........                                                              [ 86%]
services/task_derivation/tests/unit/infrastructure/handlers/test_derive_tasks_handler.py . [ 87%]
........                                                                 [ 87%]
services/task_derivation/tests/unit/infrastructure/handlers/test_process_result_handler.py . [ 87%]
...........                                                              [ 88%]
services/task_derivation/tests/unit/infrastructure/mappers/test_llm_task_derivation_mapper.py . [ 88%]
..                                                                       [ 88%]
services/task_derivation/tests/unit/infrastructure/mappers/test_nats_event_mapper.py . [ 88%]
.....                                                                    [ 88%]
services/task_derivation/tests/unit/infrastructure/mappers/test_plan_snapshot_mapper.py . [ 88%]
...                                                                      [ 88%]
services/task_derivation/tests/unit/infrastructure/mappers/test_planning_grpc_mapper.py . [ 89%]
........                                                                 [ 89%]
services/task_derivation/tests/unit/infrastructure/mappers/test_ray_executor_request_mapper.py . [ 89%]
........                                                                 [ 90%]
services/task_derivation/tests/unit/infrastructure/mappers/test_task_derivation_context_grpc_mapper.py . [ 90%]
.............                                                            [ 90%]
services/task_derivation/tests/unit/infrastructure/mappers/test_task_derivation_request_mapper.py . [ 90%]
..                                                                       [ 90%]
services/task_derivation/tests/unit/test_server.py .................     [ 91%]
services/workflow/tests/unit/application/test_execute_workflow_action_usecase.py . [ 92%]
....                                                                     [ 92%]
services/workflow/tests/unit/application/test_get_pending_tasks_usecase.py . [ 92%]
..                                                                       [ 92%]
services/workflow/tests/unit/application/test_get_workflow_state_usecase.py . [ 92%]
.                                                                        [ 92%]
services/workflow/tests/unit/application/test_initialize_task_workflow_usecase.py . [ 92%]
.....                                                                    [ 92%]
services/workflow/tests/unit/application/test_planning_event_dto.py .... [ 93%]
...                                                                      [ 93%]
services/workflow/tests/unit/domain/test_role.py ..........              [ 93%]
services/workflow/tests/unit/domain/test_state_transition.py ........    [ 94%]
services/workflow/tests/unit/domain/test_task_id.py ....                 [ 94%]
services/workflow/tests/unit/domain/test_workflow_state.py .........     [ 95%]
services/workflow/tests/unit/domain/test_workflow_state_collection.py .. [ 95%]
..                                                                       [ 95%]
services/workflow/tests/unit/domain/test_workflow_state_enum.py ....     [ 95%]
services/workflow/tests/unit/domain/test_workflow_state_factory.py ..... [ 95%]
......                                                                   [ 96%]
services/workflow/tests/unit/domain/test_workflow_state_machine.py ..... [ 96%]
.....                                                                    [ 96%]
services/workflow/tests/unit/domain/test_workflow_state_metadata.py .... [ 97%]
...                                                                      [ 97%]
services/workflow/tests/unit/infrastructure/test_grpc_workflow_mapper.py . [ 97%]
.........                                                                [ 97%]
services/workflow/tests/unit/infrastructure/test_planning_event_mapper.py . [ 97%]
........                                                                 [ 98%]
services/workflow/tests/unit/infrastructure/test_planning_events_consumer.py . [ 98%]
.........                                                                [ 98%]
services/workflow/tests/unit/infrastructure/test_server_configuration_dto.py . [ 98%]
..........                                                               [ 99%]
services/workflow/tests/unit/infrastructure/test_workflow_state_mapper.py . [ 99%]
.......                                                                  [100%]

=============================== warnings summary ===============================
services/context/tests/unit/consumers/test_planning_consumer.py:8
  /home/tirso/ai/developents/swe-ai-fleet/services/context/tests/unit/consumers/test_planning_consumer.py:8: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    pytestmark = pytest.mark.unit

services/context/tests/unit/test_server.py:12
  /home/tirso/ai/developents/swe-ai-fleet/services/context/tests/unit/test_server.py:12: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    pytestmark = pytest.mark.unit

services/orchestrator/tests/test_server.py:11
  /home/tirso/ai/developents/swe-ai-fleet/services/orchestrator/tests/test_server.py:11: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    pytestmark = pytest.mark.unit

services/context/tests/unit/test_nats_handler.py::TestContextNATSHandlerConnect::test_connect_initializes_components
services/context/tests/unit/test_nats_handler.py::TestContextNATSHandlerConnect::test_connect_handles_stream_creation_error
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:1443: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    return await func(*newargs, **newkeywargs)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/monitoring/tests/infrastructure/adapters/test_nats_connection_adapter.py::TestNATSConnectionAdapter::test_connect_success
services/monitoring/tests/infrastructure/adapters/test_nats_connection_adapter.py::TestNATSConnectionAdapter::test_is_connected_true
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/asyncio/events.py:89: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    self._context.run(self._callback, *self._args)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/monitoring/tests/infrastructure/adapters/test_nats_connection_adapter.py::TestNATSConnectionAdapter::test_disconnect
  /home/tirso/ai/developents/swe-ai-fleet/services/monitoring/infrastructure/stream_connectors/nats/adapters/nats_connection_adapter.py:42: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    self.js = None
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/orchestrator/tests/infrastructure/handlers/test_agent_response_consumer.py::test_handle_agent_failed_publishes_event
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2247: RuntimeWarning: coroutine 'OrchestratorAgentResponseConsumer._poll_completed' was never awaited
    def __init__(self, name, parent):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/orchestrator/tests/infrastructure/handlers/test_agent_response_consumer.py::test_handle_agent_failed_publishes_event
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2247: RuntimeWarning: coroutine 'OrchestratorAgentResponseConsumer._poll_failed' was never awaited
    def __init__(self, name, parent):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/orchestrator/tests/infrastructure/handlers/test_agent_response_consumer.py::test_handle_agent_failed_publishes_event
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2247: RuntimeWarning: coroutine 'OrchestratorAgentResponseConsumer._poll_progress' was never awaited
    def __init__(self, name, parent):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/orchestrator/tests/infrastructure/handlers/test_deliberation_collector.py::test_handle_agent_failed_records_failure
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2247: RuntimeWarning: coroutine 'DeliberationResultCollector._poll_completed' was never awaited
    def __init__(self, name, parent):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/orchestrator/tests/infrastructure/handlers/test_deliberation_collector.py::test_handle_agent_failed_records_failure
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2247: RuntimeWarning: coroutine 'DeliberationResultCollector._poll_failed' was never awaited
    def __init__(self, name, parent):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/orchestrator/tests/infrastructure/handlers/test_deliberation_collector.py::test_handle_agent_failed_records_failure
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2247: RuntimeWarning: coroutine 'DeliberationResultCollector._cleanup_loop' was never awaited
    def __init__(self, name, parent):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/orchestrator/tests/infrastructure/handlers/test_orchestrator_handlers.py::TestOrchestratorPlanningConsumer::test_planning_consumer_handle_plan_approved_with_auto_dispatch
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2247: RuntimeWarning: coroutine 'OrchestratorPlanningConsumer._poll_story_transitions' was never awaited
    def __init__(self, name, parent):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/orchestrator/tests/infrastructure/handlers/test_orchestrator_handlers.py::TestOrchestratorPlanningConsumer::test_planning_consumer_handle_plan_approved_with_auto_dispatch
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2247: RuntimeWarning: coroutine 'OrchestratorPlanningConsumer._poll_plan_approvals' was never awaited
    def __init__(self, name, parent):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/planning/tests/unit/infrastructure/grpc/handlers/test_list_projects_handler.py::test_list_projects_handler_invalid_status_filter
  /home/tirso/ai/developents/swe-ai-fleet/services/planning/infrastructure/grpc/handlers/list_projects_handler.py:32: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    context.set_code(grpc.StatusCode.INVALID_ARGUMENT)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/planning/tests/unit/infrastructure/grpc/handlers/test_list_projects_handler.py::test_list_projects_handler_use_case_error
  /home/tirso/ai/developents/swe-ai-fleet/services/planning/infrastructure/grpc/handlers/list_projects_handler.py:57: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    context.set_code(grpc.StatusCode.INTERNAL)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/planning/tests/unit/infrastructure/test_neo4j_adapter_unit.py::TestNeo4jAdapterStoryOperations::test_create_story_node_calls_sync_method
  /home/tirso/ai/developents/swe-ai-fleet/services/planning/infrastructure/adapters/neo4j_adapter.py:98: RuntimeWarning: coroutine 'TestNeo4jAdapterStoryOperations.test_create_story_node_calls_sync_method.<locals>.mock_coro' was never awaited
    await asyncio.to_thread(
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/planning/tests/unit/infrastructure/test_storage_adapter.py::test_list_projects_with_status_filter_delegates_to_valkey
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:2193: RuntimeWarning: coroutine 'TestNeo4jAdapterStoryOperations.test_create_story_node_calls_sync_method.<locals>.mock_coro' was never awaited
    setattr(_type, entry, MagicProxy(entry, self))
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/planning/tests/unit/infrastructure/test_valkey_adapter.py::test_valkey_adapter_init
services/planning/tests/unit/infrastructure/test_valkey_adapter.py::test_valkey_adapter_has_required_methods
services/planning/tests/unit/infrastructure/test_valkey_adapter.py::test_valkey_adapter_close
  /home/tirso/ai/developents/swe-ai-fleet/services/planning/infrastructure/adapters/valkey_adapter.py:54: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    self.client.ping()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/planning/tests/unit/infrastructure/test_valkey_adapter.py::test_valkey_adapter_close
  /home/tirso/ai/developents/swe-ai-fleet/services/planning/infrastructure/adapters/valkey_adapter.py:62: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    self.client.close()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/planning/tests/unit/infrastructure/test_valkey_adapter_unit.py::TestValkeyAdapterGetStory::test_get_story_calls_sync_method
  /home/tirso/ai/developents/swe-ai-fleet/services/planning/tests/unit/infrastructure/test_valkey_adapter_unit.py:324: RuntimeWarning: coroutine 'TestValkeyAdapterGetStory.test_get_story_calls_sync_method.<locals>.mock_coro' was never awaited
    await adapter.get_story(story_id)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/planning/tests/unit/infrastructure/test_valkey_adapter_unit.py::TestValkeyAdapterListStories::test_list_stories_calls_sync_method
  /home/tirso/ai/developents/swe-ai-fleet/services/planning/tests/unit/infrastructure/test_valkey_adapter_unit.py:404: RuntimeWarning: coroutine 'TestValkeyAdapterListStories.test_list_stories_calls_sync_method.<locals>.mock_coro' was never awaited
    await adapter.list_stories()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

services/task_derivation/tests/unit/infrastructure/consumers/test_task_derivation_result_consumer.py::test_result_consumer_extract_identifiers_missing_story_id
  /home/tirso/.pyenv/versions/3.13.7/lib/python3.13/unittest/mock.py:496: RuntimeWarning: coroutine 'TaskDerivationResultConsumer._poll' was never awaited
    __dict__['method_calls'] = _CallList()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============== 1721 passed, 5 deselected, 27 warnings in 14.32s ===============

ðŸ“Š Generating coverage.xml for SonarQube...
Wrote XML report to coverage.xml
âœ… Fixed coverage.xml source paths to relative (.)

âœ… All unit tests passed! Coverage report:
   ðŸ“Š Terminal: see above
   ðŸ“„ XML: coverage.xml
   ðŸŒ HTML: htmlcov/index.html

ðŸ§¹ Cleaning up generated stubs...
âœ… Cleanup completed
