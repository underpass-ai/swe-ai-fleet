{
  "test_id": "22-workspace-queues-readonly",
  "run_id": "e2e-ws-queues-1771109160",
  "status": "passed",
  "started_at": "2026-02-14T22:46:00.220002+00:00",
  "workspace_url": "http://workspace.swe-ai-fleet.svc.cluster.local:50053",
  "steps": [
    {
      "at": "2026-02-14T22:46:00.233954+00:00",
      "step": "health",
      "status": "passed"
    },
    {
      "at": "2026-02-14T22:46:03.255163+00:00",
      "step": "catalog",
      "status": "passed",
      "data": {
        "tool_count": 52,
        "required_tools": [
          "kafka.consume",
          "kafka.topic_metadata",
          "nats.subscribe_pull",
          "rabbit.consume",
          "rabbit.queue_info"
        ],
        "forbidden_tools": [
          "kafka.produce",
          "nats.publish",
          "rabbit.publish"
        ]
      }
    },
    {
      "at": "2026-02-14T22:46:03.261351+00:00",
      "step": "policy_deny_scopes",
      "status": "passed"
    },
    {
      "at": "2026-02-14T22:46:04.278398+00:00",
      "step": "allowlisted_reads",
      "status": "passed"
    },
    {
      "at": "2026-02-14T22:46:04.278413+00:00",
      "step": "final",
      "status": "passed"
    }
  ],
  "sessions": [
    {
      "at": "2026-02-14T22:46:03.251742+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "payload": {
        "principal": {
          "tenant_id": "e2e-tenant",
          "actor_id": "e2e-queues-readonly",
          "roles": [
            "devops"
          ]
        },
        "metadata": {
          "allowed_profiles": "dev.nats,dev.kafka,dev.rabbit",
          "allowed_nats_subjects": "sandbox.>,dev.>",
          "allowed_kafka_topics": "sandbox.,dev.",
          "allowed_rabbit_queues": "sandbox.,dev.",
          "connection_profile_endpoints_json": "{\"dev.nats\":\"nats://nats.swe-ai-fleet.svc.cluster.local:4222\",\"dev.kafka\":\"kafka.swe-ai-fleet.svc.cluster.local:9092\",\"dev.rabbit\":\"amqp://guest:guest@rabbitmq.swe-ai-fleet.svc.cluster.local:5672/\"}"
        },
        "expires_in_seconds": 3600
      }
    }
  ],
  "invocations": [
    {
      "at": "2026-02-14T22:46:03.257720+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "tool": "nats.subscribe_pull",
      "http_status": 403,
      "invocation_id": "inv-2f12e6e8003ac3a9",
      "invocation_status": "denied",
      "error_code": "policy_denied",
      "error_message": "subject not allowed"
    },
    {
      "at": "2026-02-14T22:46:03.259551+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "tool": "kafka.topic_metadata",
      "http_status": 403,
      "invocation_id": "inv-f2ca1ea4a6354846",
      "invocation_status": "denied",
      "error_code": "policy_denied",
      "error_message": "topic not allowed"
    },
    {
      "at": "2026-02-14T22:46:03.261339+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "tool": "rabbit.queue_info",
      "http_status": 403,
      "invocation_id": "inv-8ccd57d9a18bbf4a",
      "invocation_status": "denied",
      "error_code": "policy_denied",
      "error_message": "queue not allowed"
    },
    {
      "at": "2026-02-14T22:46:03.765538+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "tool": "nats.subscribe_pull",
      "http_status": 200,
      "invocation_id": "inv-ae699b720ebff3a2",
      "invocation_status": "succeeded",
      "error_code": null,
      "error_message": null
    },
    {
      "at": "2026-02-14T22:46:03.768555+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "tool": "kafka.topic_metadata",
      "http_status": 500,
      "invocation_id": "inv-99771a58c49e330e",
      "invocation_status": "failed",
      "error_code": "execution_failed",
      "error_message": "kafka topic metadata failed: failed to dial: failed to open connection to kafka.swe-ai-fleet.svc.cluster.local:9092: dial tcp: lookup kafka.swe-ai-fleet.svc.cluster.local on 10.96.0.10:53: no such host"
    },
    {
      "at": "2026-02-14T22:46:04.271528+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "tool": "kafka.consume",
      "http_status": 200,
      "invocation_id": "inv-1318a44bba7ebb48",
      "invocation_status": "succeeded",
      "error_code": null,
      "error_message": null
    },
    {
      "at": "2026-02-14T22:46:04.275245+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "tool": "rabbit.queue_info",
      "http_status": 500,
      "invocation_id": "inv-11470a7e5b866459",
      "invocation_status": "failed",
      "error_code": "execution_failed",
      "error_message": "rabbit queue_info failed: dial tcp: lookup rabbitmq.swe-ai-fleet.svc.cluster.local on 10.96.0.10:53: no such host"
    },
    {
      "at": "2026-02-14T22:46:04.278383+00:00",
      "session_id": "session-2acb6bb039f7b072",
      "tool": "rabbit.consume",
      "http_status": 500,
      "invocation_id": "inv-84dfd37859d788e5",
      "invocation_status": "failed",
      "error_code": "execution_failed",
      "error_message": "rabbit consume failed: dial tcp: lookup rabbitmq.swe-ai-fleet.svc.cluster.local on 10.96.0.10:53: no such host"
    }
  ],
  "ended_at": "2026-02-14T22:46:04.285230+00:00"
}
