{
  "test_id": "23-workspace-db-governed",
  "run_id": "e2e-ws-db-1771109178",
  "status": "passed",
  "started_at": "2026-02-14T22:46:18.251894+00:00",
  "workspace_url": "http://workspace.swe-ai-fleet.svc.cluster.local:50053",
  "steps": [
    {
      "at": "2026-02-14T22:46:18.264644+00:00",
      "step": "health",
      "status": "passed"
    },
    {
      "at": "2026-02-14T22:46:21.284309+00:00",
      "step": "catalog",
      "status": "passed",
      "data": {
        "tool_count": 52,
        "required_tools": [
          "mongo.aggregate",
          "mongo.find",
          "redis.exists",
          "redis.get",
          "redis.mget",
          "redis.scan",
          "redis.ttl"
        ],
        "forbidden_tools": [
          "mongo.delete",
          "mongo.insert",
          "mongo.update",
          "redis.del",
          "redis.set"
        ]
      }
    },
    {
      "at": "2026-02-14T22:46:21.292068+00:00",
      "step": "policy_deny_scopes",
      "status": "passed"
    },
    {
      "at": "2026-02-14T22:46:27.327435+00:00",
      "step": "allowlisted_reads",
      "status": "passed"
    },
    {
      "at": "2026-02-14T22:46:27.327451+00:00",
      "step": "final",
      "status": "passed"
    }
  ],
  "sessions": [
    {
      "at": "2026-02-14T22:46:21.281263+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "payload": {
        "principal": {
          "tenant_id": "e2e-tenant",
          "actor_id": "e2e-db-governed",
          "roles": [
            "devops"
          ]
        },
        "metadata": {
          "allowed_profiles": "dev.redis,dev.mongo",
          "allowed_redis_key_prefixes": "sandbox:,dev:",
          "connection_profile_endpoints_json": "{\"dev.redis\":\"valkey.swe-ai-fleet.svc.cluster.local:6379\",\"dev.mongo\":\"mongodb://mongodb.swe-ai-fleet.svc.cluster.local:27017\"}"
        },
        "expires_in_seconds": 3600
      }
    }
  ],
  "invocations": [
    {
      "at": "2026-02-14T22:46:21.287032+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "redis.get",
      "http_status": 403,
      "invocation_id": "inv-417719b9f25f7395",
      "invocation_status": "denied",
      "error_code": "policy_denied",
      "error_message": "key prefix not allowed"
    },
    {
      "at": "2026-02-14T22:46:21.288849+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "redis.scan",
      "http_status": 403,
      "invocation_id": "inv-beab201beb75ca15",
      "invocation_status": "denied",
      "error_code": "policy_denied",
      "error_message": "key prefix not allowed"
    },
    {
      "at": "2026-02-14T22:46:21.290400+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "mongo.find",
      "http_status": 500,
      "invocation_id": "inv-205dfe5895802984",
      "invocation_status": "failed",
      "error_code": "policy_denied",
      "error_message": "database outside profile allowlist"
    },
    {
      "at": "2026-02-14T22:46:21.292054+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "mongo.aggregate",
      "http_status": 500,
      "invocation_id": "inv-b2a52f905afca239",
      "invocation_status": "failed",
      "error_code": "policy_denied",
      "error_message": "database outside profile allowlist"
    },
    {
      "at": "2026-02-14T22:46:21.295739+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "redis.get",
      "http_status": 200,
      "invocation_id": "inv-394da684ec453fc6",
      "invocation_status": "succeeded",
      "error_code": null,
      "error_message": null
    },
    {
      "at": "2026-02-14T22:46:21.299331+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "redis.mget",
      "http_status": 200,
      "invocation_id": "inv-add0f53278ac23f1",
      "invocation_status": "succeeded",
      "error_code": null,
      "error_message": null
    },
    {
      "at": "2026-02-14T22:46:21.310127+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "redis.scan",
      "http_status": 200,
      "invocation_id": "inv-fde55b704b5fe2f5",
      "invocation_status": "succeeded",
      "error_code": null,
      "error_message": null
    },
    {
      "at": "2026-02-14T22:46:21.312963+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "redis.ttl",
      "http_status": 200,
      "invocation_id": "inv-debd0d043ccf245a",
      "invocation_status": "succeeded",
      "error_code": null,
      "error_message": null
    },
    {
      "at": "2026-02-14T22:46:21.315667+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "redis.exists",
      "http_status": 200,
      "invocation_id": "inv-40676b6bc170f1d4",
      "invocation_status": "succeeded",
      "error_code": null,
      "error_message": null
    },
    {
      "at": "2026-02-14T22:46:24.324448+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "mongo.find",
      "http_status": 500,
      "invocation_id": "inv-f203aa33a13666fb",
      "invocation_status": "failed",
      "error_code": "execution_failed",
      "error_message": "mongo find failed: server selection error: context deadline exceeded, current topology: { Type: Unknown, Servers: [{ Addr: mongodb.swe-ai-fleet.svc.cluster.local:27017, Type: Unknown, Last error: dial tcp: lookup mongodb.swe-ai-fleet.svc.cluster.local on 10.96.0.10:53: no such host }, ] }"
    },
    {
      "at": "2026-02-14T22:46:27.327413+00:00",
      "session_id": "session-6dd35dcfe196cc0e",
      "tool": "mongo.aggregate",
      "http_status": 500,
      "invocation_id": "inv-72bbeea1a5853d1d",
      "invocation_status": "failed",
      "error_code": "execution_failed",
      "error_message": "mongo aggregate failed: server selection error: context deadline exceeded, current topology: { Type: Unknown, Servers: [{ Addr: mongodb.swe-ai-fleet.svc.cluster.local:27017, Type: Unknown, Last error: dial tcp: lookup mongodb.swe-ai-fleet.svc.cluster.local on 10.96.0.10:53: no such host }, ] }"
    }
  ],
  "ended_at": "2026-02-14T22:46:27.334486+00:00"
}
